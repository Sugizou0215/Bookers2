<div class="container px-5 px-sm-0">
  <div class="row">
    <%#サイドバー%>
    <%= render 'users/sidebar', user: @user, book: @new_book %>
    <%#投稿詳細%>
    <div class="col-md-8 offset-md-1">
      <h2>Book detail</h2>
      <table class="table">
        <tbody>
          <tr>
            <td>
              <%= link_to attachment_image_tag(@book.user, :profile_image, :fill, 60, 60, fallback: "no_image.jpg"), user_path(@user.id) %></br>
              <%= link_to @user.name, user_path(@user.id) %>
            </td>
            <td>
              <%= link_to @book.title, book_path %>
            </td>
            <td><%= @book.body %></td>
            <td id="show-favorite-btn">
              <%#いいね機能%>
              <%= render "favorites/favorite-btn", book: @book %>
            </td>
            <td>コメント数：<%= @book.post_comments.count %></td>
            <% if @book.user == current_user %>
              <td><%= link_to "Edit", edit_book_path(@book.id),class:"btn btn-success btn-sm" %></td>
              <td><%= link_to "Destroy", book_path(@book), method: :delete, "data-confirm" => "本当に消しますか?", class:"btn btn-danger btn-sm" %></td>
            <% end %>
          </tr>
        </tbody>
      </table>
      <div class="comments">
        <table class="table">
          <tbody>
            <% @book.post_comments.each do |post_comment| %>
            <tr>
              <td>
                <%= attachment_image_tag(post_comment.user, :profile_image, :fill, 60, 60, fallback: "no_image.jpg") %><br>
                <%= post_comment.user.name %>
              </td>
              <td>
                <%= post_comment.comment %>
              </td>
              <td>
                <% if post_comment.user == current_user %>
                <div>
                  <%= link_to "Destroy", book_post_comment_path(post_comment.book, post_comment), method: :delete, class:"btn btn-danger btn-sm" %>
                </div>
                <% end %>
              </td>
            <% end %>
          </tbody>
        </table>
      </div>
      <div>
        <%= form_with(model:[@book, @post_comment], local: true) do |f| %>
          <%= f.text_area :comment, rows:'5', cols:'100',placeholder: "コメントをここに",class:"form-group" %>
          <p><%= f.submit "送信" %></p>
        <% end %>
      </div>

    </div>
  </div>
</div>